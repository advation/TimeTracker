<?php
    if(count($this->messages->systemMessages) > 0)
    {
        echo "
            <div class=\"section message\">
                <div class=\"row\">
                    <div class=\"small-12 columns\">";
                        foreach($this->messages->systemMessages as $message)
                        {
                            echo "<p><i class='fa fa-warning'></i> ".$message['message']."</p>";
                        }
                        echo "
                    </div>
                </div>
            </div>
        ";
    }

    if(count($this->messages->allPrivateMessages) > 0)
    {

        echo "
        <div class=\"section\">
            <div class=\"row\">
                <div class=\"small-12 columns\">
                    <div class=\"\">
                        <h2>Messages <small> </small></h2>
        ";
        echo "<ul>";
        foreach($this->messages->allPrivateMessages as $message)
        {
            $date = new DateTime();
            $date->setTimestamp($message['postDate']);
            echo "<li><b>".$date->format('l, F jS Y')."</b><br>".$message['message']."</li>";
        }
        echo "</ul>";

        echo "
                </div>
            </div>
        </div>
    </div>
        ";
    }
?>
<div class="section">
    <div class="row">
        <div class="small-6 columns">
            <div class="panel info">
            <?php
            echo "
                <div class=\"row\">
                    <div class='small-12 columns'>
                        <h2>Time submitted this week</h2>
                    </div>
                    <div class='small-12 columns text-center'>
                        <p>".$this->week['start']['month']." ".$this->week['start']['day']." ".$this->week['year']." to ".$this->week['end']['month']." ".$this->week['end']['day']." ".$this->week['year']."</p>
                    </div>
                    <div class='small-12 columns text-center'>
                        <h2>".$this->week['total']."</h2>
                    </div>
                    ";
            echo "</div>";
            ?>
            </div>
        </div>
        <div class="small-6 columns">
            <div class="panel">
            <h2><?php echo $this->month." ".$this->year ?> <small> Hours Breakout</small></h2>

            <?php

             foreach($this->timesheet->totals as $key=>$value)
             {
                 if($value > 0)
                 {
                     echo "
                    <div class='row'>
                        <div class='small-6 columns'>
                            <h4>$key</h4>
                        </div>
                        <div class='small-6 columns'>
                            <h4>$value</>
                        </div>
                    </div>
                ";
                 }
             }

             if($this->timesheet->totals['Total Time'] == 0)
             {
                 echo "
                    <div class=\"row\">
                        <div class=\"small-12 columns text-center\">
                            <h4 class='subheader'>No time submitted</h4>
                        </div>
                    </div>
                ";
             }
             ?>
            </div>
        </div>
        <div class='small-12 columns text-center'>
            <a class='button round' href="<?php echo $this->link(array('timesheet')) ?>"><i class='fa fa-clock-o'></i> Your Time Sheet</a>
        </div>
    </div>
</div>

<div id="privateMessages" class="reveal-modal medium" data-reveal aria-labelledby="privateMessages" aria-hidden="true" role="dialog">

    <?php
    if(count($this->messages->privateMessages) > 0)
    {
        $total = $this->messages->totalPrivateMessages;
        $i = 1;

        echo "<h2 id=\"modalTitle\"><i class=\"fa fa-envelope\"></i> New Message <small>$i of $total</small></h2>";
        foreach ($this->messages->privateMessages as $message)
        {
            echo "
            <p>" . $message['message'] . "</p>
            <ul class=\"button-group radius text-center\">
                <li><a class=\"button\" href=\"".$this->link(array("index","read",$message['id']))."\"><i class=\"fa fa-check-square\"></i> Mark as read</a></li>
            </ul>";
            $i++;
        }

    }
    ?>
    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
</div>

